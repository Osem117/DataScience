source('C:/Proyectos R/FID/TrabajoBicis/bike-sharing-in-r-programming modificado dividido arreglado.R', echo=TRUE)
# Lectura del dataset de entrenamiento y del de test
bike_share_train <- read.csv("./train.csv", header=T)
source('C:/Proyectos R/FID/TrabajoBicis/bike-sharing-in-r-programming modificado dividido arreglado.R', echo=TRUE)
setwd("D:/S3-DataScience/zzTrabajo")
getwd()
LoLData = read.csv("./games.csv")
getwd()
LoLData = read.csv("./games.csv")
LoLData.head()
getwd()
LoLData = read.csv("./games.csv")
LoLData
getwd()
LoLData = read.csv("./games.csv")
getwd()
LoLData = read.csv("./games.csv")
getwd()
LoLData = read.csv("./lolData/games.csv")
LoLData
getwd()
LoLData = read.csv("./lolData/games.csv")
LoLData
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(gapminder)
gapminder2007 <- gapminder %>% filter(year==2007)
ggplot( gapminder2007, aes(x = gdpPercap,y = lifeExp)) +
geom_point()
ggplot( gapminder2007, aes(x = gdpPercap,y = lifeExp)) +
geom_point() +
scale_x_log10()
ggplot( gapminder2007, aes(x = gdpPercap,y = lifeExp,color=continent)) +
geom_point() +
scale_x_log10()
ggplot( gapminder2007, aes(x = gdpPercap,y = lifeExp,color=continent,size=pop)) +
geom_point(aes(alpha=0.5)) +
scale_x_log10()
ggplot( gapminder2007, aes(x = gdpPercap,y = lifeExp,size=pop)) +
geom_point(aes(alpha=0.5)) +
scale_x_log10() +
facet_wrap(~continent)
by_year <- gapminder %>%
group_by(year) %>%
summarize(totalPop = sum(as.numeric(pop)),
meanLifeExp = mean(lifeExp))
ggplot(by_year, aes(x = year, y = totalPop)) +
geom_point()
ggplot(by_year, aes(x = year, y = totalPop)) +
geom_point() +
expand_limits(y = 0)
by_year_continent <- gapminder %>%
group_by(year, continent) %>%
summarize(totalPop = sum(as.numeric(pop)),
meanLifeExp = mean(lifeExp))
ggplot(by_year_continent, aes(x = year, y = totalPop, color = continent)) +
geom_point() +
expand_limits(y = 0)
boxplot <- ggplot(gapminder2007, aes(x = continent, y = lifeExp)) +
geom_boxplot()
boxplot_build_elements <- ggplot_build(boxplot)
boxplot_build_data <- boxplot_build_elements$data
outliers <- boxplot_build_data[[1]]$outliers
outliers
getwd()
lolData = read.csv("./lolData/games.csv")
lolData
View(LoLData)
install.packages("DT")
plot(cars)
library(ggplot2)
library(dplyr)
library(hrbrthemes)
install.packages("hrbrthemes")
install.packages("hrbrthemes")
install.packages("hrbrthemes")
install.packages("hrbrthemes")
library(ggplot2)
library(ggplot2)
install.packages("ggplot2")
library(ggplot2)
library(ggplot2)
library(ggplot2)
library(ggplot2)
library(ggplot2)
library(ggplot2)
library(ggplot2)
install.packages("ggplot2")
library(ggplot2)
library(ggplot2)
detach("package:ggplot2", unload = TRUE)
library(ggplot2)
detach("package:ggplot2", unload = TRUE)
library(ggplot2)
remove.packages("ggplot2", lib="~/R/win-library/3.6")
install.packages("ggplot2")
library(ggplot2)
detach("package:ggplot2", unload = TRUE)
library(ggplot2)
library(ggplot2)
library(scales)
dfHist = df_games
# Lectura
lol <- read.csv("./lolData/games.csv")
champions <- read.csv("./lolData/champs.csv")
con <- file("./lolData/summoner_spell_info.json", "r")
# Conversión a data frames
df_summoners <- ldply(fromJSON(con), data.frame)
library(plyr)
library(dplyr)
library(RJSONIO)
library(ggplot2)
# Lectura
lol <- read.csv("./lolData/games.csv")
champions <- read.csv("./lolData/champs.csv")
con <- file("./lolData/summoner_spell_info.json", "r")
# Conversión a data frames
df_summoners <- ldply(fromJSON(con), data.frame)
close(con)
df_games = data.frame(lol)
df_champs = data.frame(champions)
# Eliminamos las columnas irrelevantes
df_games$gameId <- NULL
df_games$seasonId <- NULL
df_games$creationTime <- NULL
df_summoners$.id <- NULL
df_summoners$summonerLevel <- NULL
df_summoners$key <- NULL
df_summoners$description <- NULL
df_games <- df_games[!(df_games$gameDuration < 900),]
df_games$winner[df_games$winner == "0"] <- "none"
df_games$winner[df_games$winner == "1"] <- "blue"
df_games$winner[df_games$winner == "2"] <- "red"
df_games$firstBlood[df_games$firstBlood == "0"] <- "none"
df_games$firstBlood[df_games$firstBlood == "1"] <- "blue"
df_games$firstBlood[df_games$firstBlood == "2"] <- "red"
df_games$firstTower[df_games$firstTower == "0"] <- "none"
df_games$firstTower[df_games$firstTower == "1"] <- "blue"
df_games$firstTower[df_games$firstTower == "2"] <- "red"
df_games$firstInhibitor[df_games$firstInhibitor == "0"] <- "none"
df_games$firstInhibitor[df_games$firstInhibitor == "1"] <- "blue"
df_games$firstInhibitor[df_games$firstInhibitor == "2"] <- "red"
df_games$firstBaron[df_games$firstBaron == "0"] <- "none"
df_games$firstBaron[df_games$firstBaron == "1"] <- "blue"
df_games$firstBaron[df_games$firstBaron == "2"] <- "red"
df_games$firstDragon[df_games$firstDragon == "0"] <- "none"
df_games$firstDragon[df_games$firstDragon == "1"] <- "blue"
df_games$firstDragon[df_games$firstDragon == "2"] <- "red"
df_games$firstRiftHerald[df_games$firstRiftHerald == "0"] <- "none"
df_games$firstRiftHerald[df_games$firstRiftHerald == "1"] <- "blue"
df_games$firstRiftHerald[df_games$firstRiftHerald == "2"] <- "red"
#Para posterior manipulación de clustering sin cambiar id -> nombre
dfClus = df_games
df_champs = rename(df_champs, t1_champ1id = 'id')
df_champs = rename(df_champs, t1_champ1Name = 'name')
df_games <- left_join(df_games, df_champs, by = 't1_champ1id')
df_games$t1_champ1id <- NULL
df_champs = rename(df_champs, t1_champ2id = 't1_champ1id')
df_champs = rename(df_champs, t1_champ2Name = 't1_champ1Name')
df_games <- left_join(df_games, df_champs, by = 't1_champ2id')
df_games$t1_champ2id <- NULL
df_champs = rename(df_champs, t1_champ3id = 't1_champ2id')
df_champs = rename(df_champs, t1_champ3Name = 't1_champ2Name')
df_games <- left_join(df_games, df_champs, by = 't1_champ3id')
df_games$t1_champ3id <- NULL
df_champs = rename(df_champs, t1_champ4id = 't1_champ3id')
df_champs = rename(df_champs, t1_champ4Name = 't1_champ3Name')
df_games <- left_join(df_games, df_champs, by = 't1_champ4id')
df_games$t1_champ4id <- NULL
df_champs = rename(df_champs, t1_champ5id = 't1_champ4id')
df_champs = rename(df_champs, t1_champ5Name = 't1_champ4Name')
df_games <- left_join(df_games, df_champs, by = 't1_champ5id')
df_games$t1_champ5id <- NULL
df_summoners = rename(df_summoners, t1_champ1_sum1 = 'id')
df_summoners = rename(df_summoners, t1_champ1_sumName1 = 'name')
df_games <- left_join(df_games, df_summoners, by = 't1_champ1_sum1')
df_games$t1_champ1_sum1 <- NULL
df_summoners = rename(df_summoners, t1_champ1_sum2 = 't1_champ1_sum1')
df_summoners = rename(df_summoners, t1_champ1_sumName2 = 't1_champ1_sumName1')
df_games <- left_join(df_games, df_summoners, by = 't1_champ1_sum2')
df_games$t1_champ1_sum2 <- NULL
df_summoners = rename(df_summoners, t1_champ2_sum1 = 't1_champ1_sum2')
df_summoners = rename(df_summoners, t1_champ2_sumName1 = 't1_champ1_sumName2')
df_games <- left_join(df_games, df_summoners, by = 't1_champ2_sum1')
df_games$t1_champ2_sum1 <- NULL
df_summoners = rename(df_summoners, t1_champ2_sum2 = 't1_champ2_sum1')
df_summoners = rename(df_summoners, t1_champ2_sumName2 = 't1_champ2_sumName1')
df_games <- left_join(df_games, df_summoners, by = 't1_champ2_sum2')
df_games$t1_champ2_sum2 <- NULL
df_summoners = rename(df_summoners, t1_champ3_sum1 = 't1_champ2_sum2')
df_summoners = rename(df_summoners, t1_champ3_sumName1 = 't1_champ2_sumName2')
df_games <- left_join(df_games, df_summoners, by = 't1_champ3_sum1')
df_games$t1_champ3_sum1 <- NULL
df_summoners = rename(df_summoners, t1_champ3_sum2 = 't1_champ3_sum1')
df_summoners = rename(df_summoners, t1_champ3_sumName2 = 't1_champ3_sumName1')
df_games <- left_join(df_games, df_summoners, by = 't1_champ3_sum2')
df_games$t1_champ3_sum2 <- NULL
df_summoners = rename(df_summoners, t1_champ4_sum1 = 't1_champ3_sum2')
df_summoners = rename(df_summoners, t1_champ4_sumName1 = 't1_champ3_sumName2')
df_games <- left_join(df_games, df_summoners, by = 't1_champ4_sum1')
df_games$t1_champ4_sum1 <- NULL
df_summoners = rename(df_summoners, t1_champ4_sum2 = 't1_champ4_sum1')
df_summoners = rename(df_summoners, t1_champ4_sumName2 = 't1_champ4_sumName1')
df_games <- left_join(df_games, df_summoners, by = 't1_champ4_sum2')
df_games$t1_champ4_sum2 <- NULL
df_summoners = rename(df_summoners, t1_champ5_sum1 = 't1_champ4_sum2')
df_summoners = rename(df_summoners, t1_champ5_sumName1 = 't1_champ4_sumName2')
df_games <- left_join(df_games, df_summoners, by = 't1_champ5_sum1')
df_games$t1_champ5_sum1 <- NULL
df_summoners = rename(df_summoners, t1_champ5_sum2 = 't1_champ5_sum1')
df_summoners = rename(df_summoners, t1_champ5_sumName2 = 't1_champ5_sumName1')
df_games <- left_join(df_games, df_summoners, by = 't1_champ5_sum2')
df_games$t1_champ5_sum2 <- NULL
df_champs = rename(df_champs, t1_ban1 = 't1_champ5id')
df_champs = rename(df_champs, t1_banName1 = 't1_champ5Name')
df_games <- left_join(df_games, df_champs, by = 't1_ban1')
df_games$t1_ban1 <- NULL
df_champs = rename(df_champs, t1_ban2 = 't1_ban1')
df_champs = rename(df_champs, t1_banName2 = 't1_banName1')
df_games <- left_join(df_games, df_champs, by = 't1_ban2')
df_games$t1_ban2 <- NULL
df_champs = rename(df_champs, t1_ban3 = 't1_ban2')
df_champs = rename(df_champs, t1_banName3 = 't1_banName2')
df_games <- left_join(df_games, df_champs, by = 't1_ban3')
df_games$t1_ban3 <- NULL
df_champs = rename(df_champs, t1_ban4 = 't1_ban3')
df_champs = rename(df_champs, t1_banName4 = 't1_banName3')
df_games <- left_join(df_games, df_champs, by = 't1_ban4')
df_games$t1_ban4 <- NULL
df_champs = rename(df_champs, t1_ban5 = 't1_ban4')
df_champs = rename(df_champs, t1_banName5 = 't1_banName4')
df_games <- left_join(df_games, df_champs, by = 't1_ban5')
df_games$t1_ban5 <- NULL
df_champs = rename(df_champs, t2_champ1id = 't1_ban5')
df_champs = rename(df_champs, t2_champ1Name = 't1_banName5')
df_games <- left_join(df_games, df_champs, by = 't2_champ1id')
df_games$t2_champ1id <- NULL
df_champs = rename(df_champs, t2_champ2id = 't2_champ1id')
df_champs = rename(df_champs, t2_champ2Name = 't2_champ1Name')
df_games <- left_join(df_games, df_champs, by = 't2_champ2id')
df_games$t2_champ2id <- NULL
df_champs = rename(df_champs, t2_champ3id = 't2_champ2id')
df_champs = rename(df_champs, t2_champ3Name = 't2_champ2Name')
df_games <- left_join(df_games, df_champs, by = 't2_champ3id')
df_games$t2_champ3id <- NULL
df_champs = rename(df_champs, t2_champ4id = 't2_champ3id')
df_champs = rename(df_champs, t2_champ4Name = 't2_champ3Name')
df_games <- left_join(df_games, df_champs, by = 't2_champ4id')
df_games$t2_champ4id <- NULL
df_champs = rename(df_champs, t2_champ5id = 't2_champ4id')
df_champs = rename(df_champs, t2_champ5Name = 't2_champ4Name')
df_games <- left_join(df_games, df_champs, by = 't2_champ5id')
df_games$t2_champ5id <- NULL
df_summoners = rename(df_summoners, t2_champ1_sum1 = 't1_champ5_sum2')
df_summoners = rename(df_summoners, t2_champ1_sumName1 = 't1_champ5_sumName2')
df_games <- left_join(df_games, df_summoners, by = 't2_champ1_sum1')
df_games$t2_champ1_sum1 <- NULL
df_summoners = rename(df_summoners, t2_champ1_sum2 = 't2_champ1_sum1')
df_summoners = rename(df_summoners, t2_champ1_sumName2 = 't2_champ1_sumName1')
df_games <- left_join(df_games, df_summoners, by = 't2_champ1_sum2')
df_games$t2_champ1_sum2 <- NULL
df_summoners = rename(df_summoners, t2_champ2_sum1 = 't2_champ1_sum2')
df_summoners = rename(df_summoners, t2_champ2_sumName1 = 't2_champ1_sumName2')
df_games <- left_join(df_games, df_summoners, by = 't2_champ2_sum1')
df_games$t2_champ2_sum1 <- NULL
df_summoners = rename(df_summoners, t2_champ2_sum2 = 't2_champ2_sum1')
df_summoners = rename(df_summoners, t2_champ2_sumName2 = 't2_champ2_sumName1')
df_games <- left_join(df_games, df_summoners, by = 't2_champ2_sum2')
df_games$t2_champ2_sum2 <- NULL
df_summoners = rename(df_summoners, t2_champ3_sum1 = 't2_champ2_sum2')
df_summoners = rename(df_summoners, t2_champ3_sumName1 = 't2_champ2_sumName2')
df_games <- left_join(df_games, df_summoners, by = 't2_champ3_sum1')
df_games$t2_champ3_sum1 <- NULL
df_summoners = rename(df_summoners, t2_champ3_sum2 = 't2_champ3_sum1')
df_summoners = rename(df_summoners, t2_champ3_sumName2 = 't2_champ3_sumName1')
df_games <- left_join(df_games, df_summoners, by = 't2_champ3_sum2')
df_games$t2_champ3_sum2 <- NULL
df_summoners = rename(df_summoners, t2_champ4_sum1 = 't2_champ3_sum2')
df_summoners = rename(df_summoners, t2_champ4_sumName1 = 't2_champ3_sumName2')
df_games <- left_join(df_games, df_summoners, by = 't2_champ4_sum1')
df_games$t2_champ4_sum1 <- NULL
df_summoners = rename(df_summoners, t2_champ4_sum2 = 't2_champ4_sum1')
df_summoners = rename(df_summoners, t2_champ4_sumName2 = 't2_champ4_sumName1')
df_games <- left_join(df_games, df_summoners, by = 't2_champ4_sum2')
df_games$t2_champ4_sum2 <- NULL
df_summoners = rename(df_summoners, t2_champ5_sum1 = 't2_champ4_sum2')
df_summoners = rename(df_summoners, t2_champ5_sumName1 = 't2_champ4_sumName2')
df_games <- left_join(df_games, df_summoners, by = 't2_champ5_sum1')
df_games$t2_champ5_sum1 <- NULL
df_summoners = rename(df_summoners, t2_champ5_sum2 = 't2_champ5_sum1')
df_summoners = rename(df_summoners, t2_champ5_sumName2 = 't2_champ5_sumName1')
df_games <- left_join(df_games, df_summoners, by = 't2_champ5_sum2')
df_games$t2_champ5_sum2 <- NULL
df_champs = rename(df_champs, t2_ban1 = 't2_champ5id')
df_champs = rename(df_champs, t2_banName1 = 't2_champ5Name')
df_games <- left_join(df_games, df_champs, by = 't2_ban1')
df_games$t2_ban1 <- NULL
df_champs = rename(df_champs, t2_ban2 = 't2_ban1')
df_champs = rename(df_champs, t2_banName2 = 't2_banName1')
df_games <- left_join(df_games, df_champs, by = 't2_ban2')
df_games$t2_ban2 <- NULL
df_champs = rename(df_champs, t2_ban3 = 't2_ban2')
df_champs = rename(df_champs, t2_banName3 = 't2_banName2')
df_games <- left_join(df_games, df_champs, by = 't2_ban3')
df_games$t2_ban3 <- NULL
df_champs = rename(df_champs, t2_ban4 = 't2_ban3')
df_champs = rename(df_champs, t2_banName4 = 't2_banName3')
df_games <- left_join(df_games, df_champs, by = 't2_ban4')
df_games$t2_ban4 <- NULL
df_champs = rename(df_champs, t2_ban5 = 't2_ban4')
df_champs = rename(df_champs, t2_banName5 = 't2_banName4')
df_games <- left_join(df_games, df_champs, by = 't2_ban5')
df_games$t2_ban5 <- NULL
#Variables con los nombres en lugar de los ID
dfClusName = df_games
dfAR = df_games
library(ggplot2)
library(scales)
dfHist = df_games
#Primero elimino las columnas que no necesito.
#Delete champ names
dfHist$t1_champ1Name= NULL
dfHist$t1_champ2Name= NULL
dfHist$t1_champ3Name= NULL
dfHist$t1_champ4Name= NULL
dfHist$t1_champ5Name= NULL
dfHist$t2_champ1Name= NULL
dfHist$t2_champ2Name= NULL
dfHist$t2_champ3Name= NULL
dfHist$t2_champ4Name= NULL
dfHist$t2_champ5Name= NULL
#Delete the character's spells
#Delete team 1 spells
dfHist$t1_champ1_sumName1= NULL
dfHist$t1_champ1_sumName2= NULL
dfHist$t1_champ2_sumName1= NULL
dfHist$t1_champ2_sumName2= NULL
dfHist$t1_champ3_sumName1= NULL
dfHist$t1_champ3_sumName2= NULL
dfHist$t1_champ4_sumName1= NULL
dfHist$t1_champ4_sumName2= NULL
dfHist$t1_champ5_sumName1= NULL
dfHist$t1_champ5_sumName2= NULL
#Delete team 2 spells
dfHist$t2_champ1_sumName1= NULL
dfHist$t2_champ1_sumName2= NULL
dfHist$t2_champ2_sumName1= NULL
dfHist$t2_champ2_sumName2= NULL
dfHist$t2_champ3_sumName1= NULL
dfHist$t2_champ3_sumName2= NULL
dfHist$t2_champ4_sumName1= NULL
dfHist$t2_champ4_sumName2= NULL
dfHist$t2_champ5_sumName1= NULL
dfHist$t2_champ5_sumName2= NULL
#Delete the bans made
#Delete bans t1
dfHist$t1_banName1 = NULL
dfHist$t1_banName2 = NULL
dfHist$t1_banName3 = NULL
dfHist$t1_banName4 = NULL
dfHist$t1_banName5 = NULL
#Delete bans t2
dfHist$t2_banName1 = NULL
dfHist$t2_banName2 = NULL
dfHist$t2_banName3 = NULL
dfHist$t2_banName4 = NULL
dfHist$t2_banName5 = NULL
attach(dfHist)
# Represento en Histogramas cuántas veces se ha llevado el equipo azul
# el primer heraldo y la primera torre.
# View First Rift Herald
ggplot(dfHist, aes(x = firstRiftHerald, fill = firstRiftHerald)) +
geom_bar() + geom_text(stat='count',aes(label=..count..),vjust=-0.25) +
scale_fill_manual(values=c("#00BFC4","#D3D3D3","#F8766D")) +
scale_y_continuous(name= "Games") +
scale_x_discrete(name = "First Rift Herald", labels = c('Blue','None','Red'))
# View First Tower
ggplot(dfHist, aes(x = firstTower, fill = firstTower)) +
geom_bar() + geom_text(stat='count',aes(label=..count..),vjust=-0.25) +
scale_fill_manual(values=c("#00BFC4","#D3D3D3","#F8766D")) +
scale_y_continuous(name= "Games") +
scale_x_discrete(name = "First Tower", labels = c('Blue','None','Red'))
# Probabilidad del quipo azul de tirar primera torre
# si se hace al primer heraldo.
tableFT<- table(firstTower)
tableFRH<- table(firstRiftHerald)
table_RH_FT<- table(firstRiftHerald, firstTower)
p_firstTowerIfFRH<-percent(table_RH_FT[1,1]/ tableFT[1])
p_firstTowerIfFRH
# Probabilidad de tirar primera torre del equipo azul
# si nadie ha hecho el primer heraldo
table_RH_FT<- table(firstRiftHerald, firstTower)
p_firstTowerT1<-percent(table_RH_FT[2,1]/ tableFT[1])
p_firstTowerT1
# Probabilidad de tirar primera torre del equipo rojo
# si nadie ha hecho el primer heraldo
table_RH_FT<- table(firstRiftHerald, firstTower)
p_firstTowerT2<-percent(table_RH_FT[2,3]/ tableFT[3])
p_firstTowerT2
# Convierto a tabla y dataframe
probX <- matrix(c (36.4, 50, 49.2), ncol=3, nrow = 1, byrow=TRUE)
colnames(probX) <- c("p_firstTowerIfFRH","p_firstTowerT1","p_firstTowerT2")
rownames(probX) <- c("Probability")
probX <- as.table(probX)
probX
prob1 <- as.data.frame(probX)
Prob1_plot<- ggplot(prob1, aes(x=rownames(prob1), Freq)) + geom_bar(stat='identity', fill = "#FF6666", colour="black") +
geom_text(aes(label = Freq, vjust = 3)) +
scale_y_continuous(name= "Probabilities %") +
scale_x_discrete(name = "First Tower with and witout Herald", labels = c('First Tower with First Herald','T1 First Tower withot Herald','T2 First Tower withot Herald')) +
ggtitle("Probabilities % of getting First Tower")
Prob1_plot + theme(plot.title = element_text(color="Black", size=12, face="bold.italic"))
# CONCLUSIÓN: Aquí estamos estudiando la relación entre Hacer Primer Heraldo + Tirar Primera Torre. Como se puede observar en el gráfico, el hecho de hacer el primer heraldo no es muy relevante ya que nos da un 36,4% de probabilidad que el equipo azul tire la primera torre teniendo el primer heraldo. Esto se puede deber a que las partidas del dataset son de equipos "low rank" y no se interesan mucho por hacer objetivos, ya que teniendo el heraldo permite conseguir una ventaja a la hora de tirar torres, ventaja muy importante en el early game para superar al enemigo en oro. Después se puede observar que sin tener el Heraldo los dos equipos tienen casi la misma probabilidad de tirar la primera torre.
