---
title: "League of Legends Games"
output: html_notebook
---

## Instalación e importación de las librerías necesarias.

```{r}

#install.packages("RJSONIO")
#install.packages("plyr")
#install.packages("dplyr")

library(plyr)
library(dplyr)
library(RJSONIO)
library(ggplot2)
library(cluster)
library(factoextra)

```

## Lectura de datasets.

* Cargamos los datos del fichero csv con la información sobre las partidas en la variable "lol".
* Cargamos los datos del fichero csv que contiene la correspondencia entre los nombres de los campeones y sus IDs en la variable "champions".
* Cargamos los datos del fichero JSON que contiene la correspondencia entre los nombres de los hechizos y sus IDs en la variable "summoners".

```{r}
# Lectura
lol <- read.csv("./lolData/games.csv")
champions <- read.csv("./lolData/champs.csv")
con <- file("./lolData/summoner_spell_info.json", "r")

# Conversión a data frames
df_summoners <- ldply(fromJSON(con), data.frame)
close(con)
df_games = data.frame(lol)
df_champs = data.frame(champions)
```

## Limpieza de datasets.

* Eliminar los atributos que no sean relevantes para nuestro análisis.
* Eliminar los ejemplos de partidas cuya duración es menor a 15 minutos. Esto quiere decir que la partida ha finalizado por razones fuera de lo normal, por ejemplo, que algún jugador no esté conectado.
* Sustituir el orden numérico atribuido a los equipos (0, 1, 2) por una etiqueta que lo represente ("none", "blue", "red").
* Sustituir el identificador numérico de los campeones seleccionados y baneados por cada uno de los jugadores de ambos equipos por el nombre del campeón en el juego.
* Sustituir el identificador numérico de los dos hechizos que cada uno de los jugadores de ambos equipos usarán en la partida por el nombre del hechizo en el juego.


```{r}
# Eliminamos las columnas irrelevantes
df_games$gameId <- NULL
df_games$seasonId <- NULL
df_games$creationTime <- NULL

df_summoners$.id <- NULL
df_summoners$summonerLevel <- NULL
df_summoners$key <- NULL
df_summoners$description <- NULL

df_games <- df_games[!(df_games$gameDuration < 900),]

df_games$winner[df_games$winner == "0"] <- "none"
df_games$winner[df_games$winner == "1"] <- "blue"
df_games$winner[df_games$winner == "2"] <- "red"

df_games$firstBlood[df_games$firstBlood == "0"] <- "none"
df_games$firstBlood[df_games$firstBlood == "1"] <- "blue"
df_games$firstBlood[df_games$firstBlood == "2"] <- "red"

df_games$firstTower[df_games$firstTower == "0"] <- "none"
df_games$firstTower[df_games$firstTower == "1"] <- "blue"
df_games$firstTower[df_games$firstTower == "2"] <- "red"

df_games$firstInhibitor[df_games$firstInhibitor == "0"] <- "none"
df_games$firstInhibitor[df_games$firstInhibitor == "1"] <- "blue"
df_games$firstInhibitor[df_games$firstInhibitor == "2"] <- "red"

df_games$firstBaron[df_games$firstBaron == "0"] <- "none"
df_games$firstBaron[df_games$firstBaron == "1"] <- "blue"
df_games$firstBaron[df_games$firstBaron == "2"] <- "red"

df_games$firstDragon[df_games$firstDragon == "0"] <- "none"
df_games$firstDragon[df_games$firstDragon == "1"] <- "blue"
df_games$firstDragon[df_games$firstDragon == "2"] <- "red"

df_games$firstRiftHerald[df_games$firstRiftHerald == "0"] <- "none"
df_games$firstRiftHerald[df_games$firstRiftHerald == "1"] <- "blue"
df_games$firstRiftHerald[df_games$firstRiftHerald == "2"] <- "red"


#Para posterior manipulación de clustering sin cambiar id -> nombre
dfClus = df_games

```

#Cambio de id -> nombre de champions 
```{r}


df_champs = rename(df_champs, t1_champ1id = 'id')
df_champs = rename(df_champs, t1_champ1Name = 'name')

df_games <- left_join(df_games, df_champs, by = 't1_champ1id')
df_games$t1_champ1id <- NULL


df_champs = rename(df_champs, t1_champ2id = 't1_champ1id')
df_champs = rename(df_champs, t1_champ2Name = 't1_champ1Name')

df_games <- left_join(df_games, df_champs, by = 't1_champ2id')
df_games$t1_champ2id <- NULL


df_champs = rename(df_champs, t1_champ3id = 't1_champ2id')
df_champs = rename(df_champs, t1_champ3Name = 't1_champ2Name')

df_games <- left_join(df_games, df_champs, by = 't1_champ3id')
df_games$t1_champ3id <- NULL


df_champs = rename(df_champs, t1_champ4id = 't1_champ3id')
df_champs = rename(df_champs, t1_champ4Name = 't1_champ3Name')

df_games <- left_join(df_games, df_champs, by = 't1_champ4id')
df_games$t1_champ4id <- NULL


df_champs = rename(df_champs, t1_champ5id = 't1_champ4id')
df_champs = rename(df_champs, t1_champ5Name = 't1_champ4Name')

df_games <- left_join(df_games, df_champs, by = 't1_champ5id')
df_games$t1_champ5id <- NULL


df_summoners = rename(df_summoners, t1_champ1_sum1 = 'id')
df_summoners = rename(df_summoners, t1_champ1_sumName1 = 'name')

df_games <- left_join(df_games, df_summoners, by = 't1_champ1_sum1')
df_games$t1_champ1_sum1 <- NULL


df_summoners = rename(df_summoners, t1_champ1_sum2 = 't1_champ1_sum1')
df_summoners = rename(df_summoners, t1_champ1_sumName2 = 't1_champ1_sumName1')

df_games <- left_join(df_games, df_summoners, by = 't1_champ1_sum2')
df_games$t1_champ1_sum2 <- NULL


df_summoners = rename(df_summoners, t1_champ2_sum1 = 't1_champ1_sum2')
df_summoners = rename(df_summoners, t1_champ2_sumName1 = 't1_champ1_sumName2')

df_games <- left_join(df_games, df_summoners, by = 't1_champ2_sum1')
df_games$t1_champ2_sum1 <- NULL


df_summoners = rename(df_summoners, t1_champ2_sum2 = 't1_champ2_sum1')
df_summoners = rename(df_summoners, t1_champ2_sumName2 = 't1_champ2_sumName1')

df_games <- left_join(df_games, df_summoners, by = 't1_champ2_sum2')
df_games$t1_champ2_sum2 <- NULL


df_summoners = rename(df_summoners, t1_champ3_sum1 = 't1_champ2_sum2')
df_summoners = rename(df_summoners, t1_champ3_sumName1 = 't1_champ2_sumName2')

df_games <- left_join(df_games, df_summoners, by = 't1_champ3_sum1')
df_games$t1_champ3_sum1 <- NULL


df_summoners = rename(df_summoners, t1_champ3_sum2 = 't1_champ3_sum1')
df_summoners = rename(df_summoners, t1_champ3_sumName2 = 't1_champ3_sumName1')

df_games <- left_join(df_games, df_summoners, by = 't1_champ3_sum2')
df_games$t1_champ3_sum2 <- NULL


df_summoners = rename(df_summoners, t1_champ4_sum1 = 't1_champ3_sum2')
df_summoners = rename(df_summoners, t1_champ4_sumName1 = 't1_champ3_sumName2')

df_games <- left_join(df_games, df_summoners, by = 't1_champ4_sum1')
df_games$t1_champ4_sum1 <- NULL


df_summoners = rename(df_summoners, t1_champ4_sum2 = 't1_champ4_sum1')
df_summoners = rename(df_summoners, t1_champ4_sumName2 = 't1_champ4_sumName1')

df_games <- left_join(df_games, df_summoners, by = 't1_champ4_sum2')
df_games$t1_champ4_sum2 <- NULL


df_summoners = rename(df_summoners, t1_champ5_sum1 = 't1_champ4_sum2')
df_summoners = rename(df_summoners, t1_champ5_sumName1 = 't1_champ4_sumName2')

df_games <- left_join(df_games, df_summoners, by = 't1_champ5_sum1')
df_games$t1_champ5_sum1 <- NULL


df_summoners = rename(df_summoners, t1_champ5_sum2 = 't1_champ5_sum1')
df_summoners = rename(df_summoners, t1_champ5_sumName2 = 't1_champ5_sumName1')

df_games <- left_join(df_games, df_summoners, by = 't1_champ5_sum2')
df_games$t1_champ5_sum2 <- NULL


df_champs = rename(df_champs, t1_ban1 = 't1_champ5id')
df_champs = rename(df_champs, t1_banName1 = 't1_champ5Name')

df_games <- left_join(df_games, df_champs, by = 't1_ban1')
df_games$t1_ban1 <- NULL


df_champs = rename(df_champs, t1_ban2 = 't1_ban1')
df_champs = rename(df_champs, t1_banName2 = 't1_banName1')

df_games <- left_join(df_games, df_champs, by = 't1_ban2')
df_games$t1_ban2 <- NULL


df_champs = rename(df_champs, t1_ban3 = 't1_ban2')
df_champs = rename(df_champs, t1_banName3 = 't1_banName2')

df_games <- left_join(df_games, df_champs, by = 't1_ban3')
df_games$t1_ban3 <- NULL


df_champs = rename(df_champs, t1_ban4 = 't1_ban3')
df_champs = rename(df_champs, t1_banName4 = 't1_banName3')

df_games <- left_join(df_games, df_champs, by = 't1_ban4')
df_games$t1_ban4 <- NULL


df_champs = rename(df_champs, t1_ban5 = 't1_ban4')
df_champs = rename(df_champs, t1_banName5 = 't1_banName4')

df_games <- left_join(df_games, df_champs, by = 't1_ban5')
df_games$t1_ban5 <- NULL


df_champs = rename(df_champs, t2_champ1id = 't1_ban5')
df_champs = rename(df_champs, t2_champ1Name = 't1_banName5')

df_games <- left_join(df_games, df_champs, by = 't2_champ1id')
df_games$t2_champ1id <- NULL


df_champs = rename(df_champs, t2_champ2id = 't2_champ1id')
df_champs = rename(df_champs, t2_champ2Name = 't2_champ1Name')

df_games <- left_join(df_games, df_champs, by = 't2_champ2id')
df_games$t2_champ2id <- NULL


df_champs = rename(df_champs, t2_champ3id = 't2_champ2id')
df_champs = rename(df_champs, t2_champ3Name = 't2_champ2Name')

df_games <- left_join(df_games, df_champs, by = 't2_champ3id')
df_games$t2_champ3id <- NULL


df_champs = rename(df_champs, t2_champ4id = 't2_champ3id')
df_champs = rename(df_champs, t2_champ4Name = 't2_champ3Name')

df_games <- left_join(df_games, df_champs, by = 't2_champ4id')
df_games$t2_champ4id <- NULL


df_champs = rename(df_champs, t2_champ5id = 't2_champ4id')
df_champs = rename(df_champs, t2_champ5Name = 't2_champ4Name')

df_games <- left_join(df_games, df_champs, by = 't2_champ5id')
df_games$t2_champ5id <- NULL


df_summoners = rename(df_summoners, t2_champ1_sum1 = 't1_champ5_sum2')
df_summoners = rename(df_summoners, t2_champ1_sumName1 = 't1_champ5_sumName2')

df_games <- left_join(df_games, df_summoners, by = 't2_champ1_sum1')
df_games$t2_champ1_sum1 <- NULL


df_summoners = rename(df_summoners, t2_champ1_sum2 = 't2_champ1_sum1')
df_summoners = rename(df_summoners, t2_champ1_sumName2 = 't2_champ1_sumName1')

df_games <- left_join(df_games, df_summoners, by = 't2_champ1_sum2')
df_games$t2_champ1_sum2 <- NULL


df_summoners = rename(df_summoners, t2_champ2_sum1 = 't2_champ1_sum2')
df_summoners = rename(df_summoners, t2_champ2_sumName1 = 't2_champ1_sumName2')

df_games <- left_join(df_games, df_summoners, by = 't2_champ2_sum1')
df_games$t2_champ2_sum1 <- NULL


df_summoners = rename(df_summoners, t2_champ2_sum2 = 't2_champ2_sum1')
df_summoners = rename(df_summoners, t2_champ2_sumName2 = 't2_champ2_sumName1')

df_games <- left_join(df_games, df_summoners, by = 't2_champ2_sum2')
df_games$t2_champ2_sum2 <- NULL


df_summoners = rename(df_summoners, t2_champ3_sum1 = 't2_champ2_sum2')
df_summoners = rename(df_summoners, t2_champ3_sumName1 = 't2_champ2_sumName2')

df_games <- left_join(df_games, df_summoners, by = 't2_champ3_sum1')
df_games$t2_champ3_sum1 <- NULL


df_summoners = rename(df_summoners, t2_champ3_sum2 = 't2_champ3_sum1')
df_summoners = rename(df_summoners, t2_champ3_sumName2 = 't2_champ3_sumName1')

df_games <- left_join(df_games, df_summoners, by = 't2_champ3_sum2')
df_games$t2_champ3_sum2 <- NULL


df_summoners = rename(df_summoners, t2_champ4_sum1 = 't2_champ3_sum2')
df_summoners = rename(df_summoners, t2_champ4_sumName1 = 't2_champ3_sumName2')

df_games <- left_join(df_games, df_summoners, by = 't2_champ4_sum1')
df_games$t2_champ4_sum1 <- NULL


df_summoners = rename(df_summoners, t2_champ4_sum2 = 't2_champ4_sum1')
df_summoners = rename(df_summoners, t2_champ4_sumName2 = 't2_champ4_sumName1')

df_games <- left_join(df_games, df_summoners, by = 't2_champ4_sum2')
df_games$t2_champ4_sum2 <- NULL


df_summoners = rename(df_summoners, t2_champ5_sum1 = 't2_champ4_sum2')
df_summoners = rename(df_summoners, t2_champ5_sumName1 = 't2_champ4_sumName2')

df_games <- left_join(df_games, df_summoners, by = 't2_champ5_sum1')
df_games$t2_champ5_sum1 <- NULL


df_summoners = rename(df_summoners, t2_champ5_sum2 = 't2_champ5_sum1')
df_summoners = rename(df_summoners, t2_champ5_sumName2 = 't2_champ5_sumName1')

df_games <- left_join(df_games, df_summoners, by = 't2_champ5_sum2')
df_games$t2_champ5_sum2 <- NULL


df_champs = rename(df_champs, t2_ban1 = 't2_champ5id')
df_champs = rename(df_champs, t2_banName1 = 't2_champ5Name')

df_games <- left_join(df_games, df_champs, by = 't2_ban1')
df_games$t2_ban1 <- NULL


df_champs = rename(df_champs, t2_ban2 = 't2_ban1')
df_champs = rename(df_champs, t2_banName2 = 't2_banName1')

df_games <- left_join(df_games, df_champs, by = 't2_ban2')
df_games$t2_ban2 <- NULL


df_champs = rename(df_champs, t2_ban3 = 't2_ban2')
df_champs = rename(df_champs, t2_banName3 = 't2_banName2')

df_games <- left_join(df_games, df_champs, by = 't2_ban3')
df_games$t2_ban3 <- NULL


df_champs = rename(df_champs, t2_ban4 = 't2_ban3')
df_champs = rename(df_champs, t2_banName4 = 't2_banName3')

df_games <- left_join(df_games, df_champs, by = 't2_ban4')
df_games$t2_ban4 <- NULL


df_champs = rename(df_champs, t2_ban5 = 't2_ban4')
df_champs = rename(df_champs, t2_banName5 = 't2_banName4')

df_games <- left_join(df_games, df_champs, by = 't2_ban5')
df_games$t2_ban5 <- NULL


#Variables con los nombres en lugar de los ID 
dfClusName = df_games
dfAR = df_games

```


#Chunk arboles de decisión. (Alicia)
```{r}

```


#Histogramas comparativos (María)
```{r}

library(ggplot2)

dfHist = df_games

#Primero elimino las columnas que no necesito.

#Delete champ names

dfHist$t1_champ1Name= NULL
dfHist$t1_champ2Name= NULL
dfHist$t1_champ3Name= NULL
dfHist$t1_champ4Name= NULL
dfHist$t1_champ5Name= NULL
dfHist$t2_champ1Name= NULL
dfHist$t2_champ2Name= NULL
dfHist$t2_champ3Name= NULL
dfHist$t2_champ4Name= NULL
dfHist$t2_champ5Name= NULL

#Delete the character's spells

#Delete team 1 spells
dfHist$t1_champ1_sumName1= NULL
dfHist$t1_champ1_sumName2= NULL

dfHist$t1_champ2_sumName1= NULL
dfHist$t1_champ2_sumName2= NULL

dfHist$t1_champ3_sumName1= NULL
dfHist$t1_champ3_sumName2= NULL

dfHist$t1_champ4_sumName1= NULL
dfHist$t1_champ4_sumName2= NULL

dfHist$t1_champ5_sumName1= NULL
dfHist$t1_champ5_sumName2= NULL

#Delete team 2 spells
dfHist$t2_champ1_sumName1= NULL
dfHist$t2_champ1_sumName2= NULL

dfHist$t2_champ2_sumName1= NULL
dfHist$t2_champ2_sumName2= NULL

dfHist$t2_champ3_sumName1= NULL
dfHist$t2_champ3_sumName2= NULL

dfHist$t2_champ4_sumName1= NULL
dfHist$t2_champ4_sumName2= NULL

dfHist$t2_champ5_sumName1= NULL
dfHist$t2_champ5_sumName2= NULL

#Delete the bans made

#Delete bans t1
dfHist$t1_banName1 = NULL
dfHist$t1_banName2 = NULL
dfHist$t1_banName3 = NULL
dfHist$t1_banName4 = NULL
dfHist$t1_banName5 = NULL

#Delete bans t2
dfHist$t2_banName1 = NULL
dfHist$t2_banName2 = NULL
dfHist$t2_banName3 = NULL
dfHist$t2_banName4 = NULL
dfHist$t2_banName5 = NULL

with(dfHist, table(winner, firstBlood))

#Represento en Histogramas cuántas veces se ha llevado el equipo azul
#el primer heraldo y la primera torre.

#View First Rift Herald

ggplot(dfHist, aes(x = firstRiftHerald, fill = firstRiftHerald)) +
  geom_bar() + geom_text(stat='count',aes(label=..count..),vjust=-0.25) +
  scale_fill_manual(values=c("#00BFC4","#D3D3D3","#F8766D")) +
  scale_y_continuous(name= "Total") +
  scale_x_discrete(name = "First Rift Herald", labels = c('Blue','None','Red'))
  
#View First Tower
  
ggplot(dfHist, aes(x = firstTower, fill = firstTower)) +
  geom_bar() + geom_text(stat='count',aes(label=..count..),vjust=-0.25) +
  scale_fill_manual(values=c("#00BFC4","#D3D3D3","#F8766D")) +
  scale_y_continuous(name= "Total") +
  scale_x_discrete(name = "First Tower", labels = c('Blue','None','Red'))

per_data <- dfHist %>%
  count(firstTower) %>%
  mutate(per= n / sum(n),
         per_label = paste0(round(per*100), "%"))

ggplot(per_data, aes(x = firstTower, fill = firstTower), y = per) +
  geom_bar(stat = "identity", fill = "lighblue") +
  geom_text(aes(label = per_label), vjust = -0.25) +
  labs(x = "Team",
       y = "Count") +
  scale_y_continuous(labels = scales::percent) +
  theme_bw()


```

```{r}

#Parte individual

#Gráfico de la duración de las partidas.

#First Dragon

ggplot(dfHist, aes(firstDragon, fill = firstDragon  ) ) +
  geom_bar() + geom_text(stat='count',aes(label=..count..),vjust=-0.25) +
  scale_fill_manual(values=c("#00BFC4", "#D3D3D3", "#F8766D")) +
  scale_y_continuous(name= "Frequency") +
  scale_x_discrete(name = "First Dragon", labels = c('Blue','None','Red'))
  firstDragon + theme(legend.position="none")

#View winning rates

ggplot(dfHist, aes(x = winner, fill = winner)) +
  geom_bar() + geom_text(stat='count',aes(label=..count..),vjust=-0.25) +
  scale_fill_manual(values=c("#00BFC4", "#F8766D")) +
  scale_y_continuous(name= "Frequency") +
  scale_x_discrete(name = "Winning Team", labels = c('Blue','Red')) 
 
#View First Blood

ggplot(dfHist, aes(x = firstBlood, fill = firstBlood)) +
  geom_bar() + geom_text(stat='count',aes(label=..count..),vjust=-0.25) +
  scale_fill_manual(values=c("#00BFC4","#F8766D")) +
  scale_y_continuous(name= "Frequency") +
  scale_x_discrete(name = "First Blood", labels = c('Blue','Red'))
  
```


#Clústering (David)
```{r}

# Primero limpiamos las columnas que no necesitamos para quedarnos solo 
#con la duracion del juego y los personajes seleccionados

# dfClus -> dataframe con los id sin sustituir
# dfClusName -> dataframe con los id sustituidos por los nombres

dfClus = dfClusName
#Quitamos los partidos por encima de 40 minutos 
#fuente: https://www.leagueofgraphs.com/es/rankings/game-durations
dfClus
dfClus <- dfClus[!(dfClus$gameDuration > 2400),]

#transformar el tiempo. Por minutos es mucho 
dfClus$gameDuration = round(dfClus$gameDuration/60, digits = 0)

dfClus

#probamos clustering con los nombres

dfClus$winner = NULL
dfClus$firstBlood = NULL
dfClus$firstTower = NULL
dfClus$firstInhibitor = NULL
dfClus$firstBaron= NULL
dfClus$firstDragon= NULL
dfClus$firstRiftHerald= NULL

#Delete the character's spells

#Delete team 1 spells

dfClus$t1_champ1_sumName1= NULL
dfClus$t1_champ1_sumName2= NULL

dfClus$t1_champ2_sumName1= NULL
dfClus$t1_champ2_sumName2= NULL

dfClus$t1_champ3_sumName1= NULL
dfClus$t1_champ3_sumName2= NULL

dfClus$t1_champ4_sumName1= NULL
dfClus$t1_champ4_sumName2= NULL

dfClus$t1_champ5_sumName1= NULL
dfClus$t1_champ5_sumName2= NULL

#Delete team 2 spells
dfClus$t2_champ1_sumName1= NULL
dfClus$t2_champ1_sumName2= NULL

dfClus$t2_champ2_sumName1= NULL
dfClus$t2_champ2_sumName2= NULL

dfClus$t2_champ3_sumName1= NULL
dfClus$t2_champ3_sumName2= NULL

dfClus$t2_champ4_sumName1= NULL
dfClus$t2_champ4_sumName2= NULL

dfClus$t2_champ5_sumName1= NULL
dfClus$t2_champ5_sumName2= NULL

#Delete the bans made

#Delete bans t1
dfClus$t1_banName1 = NULL
dfClus$t1_banName2 = NULL
dfClus$t1_banName3 = NULL
dfClus$t1_banName4 = NULL
dfClus$t1_banName5 = NULL

#Delete bans t2
dfClus$t2_banName1 = NULL
dfClus$t2_banName2 = NULL
dfClus$t2_banName3 = NULL
dfClus$t2_banName4 = NULL
dfClus$t2_banName5 = NULL

#Delete Dragon, Tower and baron kills per team
dfClus$t1_towerKills = NULL
dfClus$t1_inhibitorKills = NULL
dfClus$t1_baronKills = NULL
dfClus$t1_dragonKills = NULL
dfClus$t1_riftHeraldKills = NULL

dfClus$t2_towerKills = NULL
dfClus$t2_inhibitorKills = NULL
dfClus$t2_baronKills = NULL
dfClus$t2_dragonKills = NULL
dfClus$t2_riftHeraldKills = NULL


#Usar la funcion table de R para hacer conteo y sumar todos los elementos

t1 = table(x=dfClus$gameDuration, y=dfClus$t1_champ1Name)
t2 = table(x=dfClus$gameDuration, y=dfClus$t1_champ2Name)
t3 = table(x=dfClus$gameDuration, y=dfClus$t1_champ3Name)
t4 = table(x=dfClus$gameDuration, y=dfClus$t1_champ4Name)
t5 = table(x=dfClus$gameDuration, y=dfClus$t1_champ5Name)

t6 = table(x=dfClus$gameDuration, y=dfClus$t2_champ1Name)
t7 = table(x=dfClus$gameDuration, y=dfClus$t2_champ2Name)
t8 = table(x=dfClus$gameDuration, y=dfClus$t2_champ3Name)
t9 = table(x=dfClus$gameDuration, y=dfClus$t2_champ4Name)
t10 = table(x=dfClus$gameDuration, y=dfClus$t2_champ5Name)

tt = t1+t2+t3+t4+t5+t6+t7+t8+t9+t10
tt

t1[1:5,1:5]
#t2[1:5,1:5]
#t3[1:5,1:5]
#tt[1:5,1:5]


#Dataframe con el conteo hecho
dt = as.data.frame(tt)

dt

#Primer plot en el que no se distinguen bien los champs
ggplot(dt, aes(x = dt$x, y = dt$y, fill=dt$Freq)) +geom_tile()


#Primer filtro. Eliminar campeones picks menor de 200
best200 <- dt[!(dt$Freq < 200),]
best200
#se visualiza mejor, pero aun es dificil obtener informacion clara
pbest200 = ggplot(best200, aes(x = best200$x, y = best200$y, fill=best200$Freq)) +geom_tile()
pbest200


#Segundo filtro. Eliminar campeones picks menor de 400
best400 <- dt[!(dt$Freq < 400),]

#se visualiza mejor, Se  puede obtener informacion clara
pbest400 = ggplot(best400, aes(x = best400$x, y = best400$y, fill=best400$Freq)) +geom_tile()
pbest400

# OPCION 1 POSIBLE ANIMALADA
# sacar media de picks por pj y quedarme con el x que coincida para 
# obtener un unico punto y hacer clustering(clustering)

  #  meanPicks = dt[(mean(dt$Freq)),]

  #  meanPicks

# OPCION 2 MAS PLAUSIBLE
# meter a saco los datos en el algoritmo cluster, a ver que pasa 

  #No se muestran los nombres. Ver los parametros
clusClara = clara(x=best400 , k=3, metric = "manhattan", stand = TRUE, samples = 50, pamLike = TRUE)
clusClara

fviz_cluster(object = clusClara, ellipse.type = "t", geom = "point",
             pointsize = 2.5) +
  theme_bw() +
  labs(title = "Resultados clustering CLARA") +
  theme(legend.position = "none")

# para hacer esto necesito los ID en lugar de los nombres porque da fallo de NAN
    # km_k = kmeans(x=best400, centers = 4, nstart = 50)


```
